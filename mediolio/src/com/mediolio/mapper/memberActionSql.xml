<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="ma">
  	<insert id="msgSend" parameterType="msvo">
		INSERT INTO message (msg_from, msg_to, msg_text, msg_date, msg_read) VALUES (#{msg_from}, #{msg_to}, #{msg_text}, now(), 'n')
	</insert>
	
  	<insert id="projectLike" parameterType="mavo">
		INSERT INTO member_action (act_type, act_to, act_from, p_id, act_date, act_read) VALUES ('like', #{act_to}, #{act_from},#{p_id}, now(), 'n')
	</insert>
	
	<delete id="projectLikeCancel" parameterType="mavo">
		DELETE FROM member_action WHERE act_type='like' AND act_from=#{act_from} AND p_id=#{p_id}
	</delete>
	
  	<select id="getProjectLike" parameterType="int" resultType="int">
		SELECT count(*) from member_action WHERE act_type='like' AND p_id=#{p_id}
	</select>
	
	<insert id="followMember" parameterType="mavo">
		INSERT INTO member_action (act_type, act_to, act_from, act_date, act_read) VALUES ('follow', #{act_to}, #{act_from}, now(), 'n')
	</insert>
	
	<delete id="followCancel" parameterType="mavo">
		DELETE FROM member_action WHERE act_type='follow' AND act_from=#{act_from} AND act_to=#{act_to}
	</delete>
	
	<select id="followCheck" parameterType = "mavo" resultType="int">
		SELECT count(*) from member_action WHERE act_type='follow' AND act_from=#{act_from} AND act_to=#{act_to}
	</select>
	
	<insert id="submitReply" parameterType="rvo" useGeneratedKeys="true" keyProperty="r_id">
		INSERT INTO reply (m_id, r_text, r_date, p_id) values (#{m_id}, #{r_text}, now(), #{p_id})
	</insert>
	
	<insert id="actionReplySumbitted" parameterType="mavo">
		INSERT INTO member_action (act_type, act_to, act_from, p_id, r_id, act_date, act_read) VALUES ('reply', #{act_to}, #{act_from}, #{p_id}, #{r_id}, now(), 'n')
	</insert>
  </mapper>
  